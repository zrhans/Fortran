echo off
load noite12.dat
A=noite12; 
u =A(:,5);
v =A(:,6);
w=A(:,7);
t=A(:,8);
q=A(:,9);
q=A(:,10);
ventomedio = sqrt((mean(u))^2+ (mean(v))^2);
%if ventomedio <= 1
 ds = (ventomedio)/10;
     k1= (2*pi)/(11*ds)
    k2= (2*pi)/(22*ds);
     k3= (2*pi)/(44*ds);
    k4= (2*pi)/(88*ds);
   k5= (2*pi)/(176*ds);
    k6= (2*pi)/(352*ds);
    k7= (2*pi)/(704*ds);
    k8= (2*pi)/(1407*ds);
     k9= (2*pi)/(2813*ds);
     k10= (2*pi)/(5626*ds);
    k11= (2*pi)/(11251*ds);
    k12= (2*pi)/(22501*ds);
    k13= (2*pi)/(45001*ds);
   k14= (2*pi)/(90001*ds);
    K = [k1; k2; k3; k4; k5; k6; k7; k8; k9; k10; k11; k12; k13; k14];
 % analise para T    
    t = A(:,8);
    N=length(t);
    [C,L] = wavedec(t,1,'haar');
    W1= detcoef(C,L,1);
    [C,L] = wavedec(t,2,'haar');
    W2= detcoef(C,L,2);
    [C,L] = wavedec(t,3,'haar');
    W3= detcoef(C,L,3);
    [C,L] = wavedec(t,4,'haar');
    W4= detcoef(C,L,4);
    [C,L] = wavedec(t,5,'haar');
    W5= detcoef(C,L,5);
    [C,L] = wavedec(t,6,'haar');
    W6= detcoef(C,L,6);
    [C,L] = wavedec(t,7,'haar');
    W7= detcoef(C,L,7);
    [C,L] = wavedec(t,8,'haar');
    W8= detcoef(C,L,8);
    [C,L] = wavedec(t,9,'haar');
    W9= detcoef(C,L,9);
    [C,L] = wavedec(t,10,'haar');
    W10= detcoef(C,L,10);
    [C,L] = wavedec(t,11,'haar');
    W11= detcoef(C,L,11);
    [C,L] = wavedec(t,12,'haar');
    W12= detcoef(C,L,12);
    [C,L] = wavedec(t,13,'haar');
    W13= detcoef(C,L,13);
    [C,L] = wavedec(t,14,'haar');
    W14= detcoef(C,L,14);
    % calculo do quadrado dos coeficienTes de da somatoria
    WW1=W1.*W1;
    WW2=W2.*W2;
    WW3=W3.*W3;
    WW4=W4.*W4;
    WW5=W5.*W5;
    WW6=W6.*W6;
    WW7=W7.*W7;
    WW8=W8.*W8;
    WW9=W9.*W9;
    WW10=W10.*W10;
    WW11=W11.*W11;
    WW12=W12.*W12;
    WW13=W13.*W13;
    WW14=W14.*W14;
    % calculo da funçao de densidade de energia
    EK1= mean(WW1)*ds/(2*pi*log(2));
    EK2= mean(WW2)*ds/(2*pi*log(2));
    EK3= mean(WW3)*ds/(2*pi*log(2));
    EK4= mean(WW4)*ds/(2*pi*log(2));
    EK5= mean(WW5)*ds/(2*pi*log(2));
    EK6= mean(WW6)*ds/(2*pi*log(2));
    EK7= mean(WW7)*ds/(2*pi*log(2));
    EK8= mean(WW8)*ds/(2*pi*log(2));
    EK9= mean(WW9)*ds/(2*pi*log(2));
    EK10=mean(WW10)*ds/(2*pi*log(2));
    EK11= mean(WW11)*ds/(2*pi*log(2));
    EK12= mean(WW12)*ds/(2*pi*log(2));
    EK13= mean(WW13)*ds/(2*pi*log(2));
    EK14= mean(WW14)*ds/(2*pi*log(2));
    EKt=[EK1; EK2; EK3; EK4; EK5; EK6; EK7; EK8; EK9; EK10; EK11; EK12; EK13; EK14;];
 % analise para U
    u = A(:,5);
    N=length(u);
    [C,L] = wavedec(u,1,'haar');
    W1= detcoef(C,L,1);
    [C,L] = wavedec(u,2,'haar');
    W2= detcoef(C,L,2);
    [C,L] = wavedec(u,3,'haar');
    W3= detcoef(C,L,3);
    [C,L] = wavedec(u,4,'haar');
    W4= detcoef(C,L,4);
    [C,L] = wavedec(u,5,'haar');
    W5= detcoef(C,L,5);
    [C,L] = wavedec(u,6,'haar');
    W6= detcoef(C,L,6);
    [C,L] = wavedec(u,7,'haar');
    W7= detcoef(C,L,7);
    [C,L] = wavedec(u,8,'haar');
    W8= detcoef(C,L,8);
    [C,L] = wavedec(u,9,'haar');
    W9= detcoef(C,L,9);
    [C,L] = wavedec(u,10,'haar');
    W10= detcoef(C,L,10);
    [C,L] = wavedec(u,11,'haar');
    W11= detcoef(C,L,11);
    [C,L] = wavedec(u,12,'haar');
    W12= detcoef(C,L,12);
    [C,L] = wavedec(u,13,'haar');
    W13= detcoef(C,L,13);
    [C,L] = wavedec(u,14,'haar');
    W14= detcoef(C,L,14);
    % calculo do quadrado dos coeficienTes de da somatoria
    WW1=W1.*W1;
    WW2=W2.*W2;
    WW3=W3.*W3;
    WW4=W4.*W4;
    WW5=W5.*W5;
    WW6=W6.*W6;
    WW7=W7.*W7;
    WW8=W8.*W8;
    WW9=W9.*W9;
    WW10=W10.*W10;
    WW11=W11.*W11;
    WW12=W12.*W12;
    WW13=W13.*W13;
    WW14=W14.*W14;
% calculo da funçao de densidade de energia
    EK1= mean(WW1)*ds/(2*pi*log(2));
    EK2= mean(WW2)*ds/(2*pi*log(2));
    EK3= mean(WW3)*ds/(2*pi*log(2));
    EK4= mean(WW4)*ds/(2*pi*log(2));
    EK5= mean(WW5)*ds/(2*pi*log(2));
    EK6= mean(WW6)*ds/(2*pi*log(2));
    EK7= mean(WW7)*ds/(2*pi*log(2));
    EK8= mean(WW8)*ds/(2*pi*log(2));
    EK9= mean(WW9)*ds/(2*pi*log(2));
    EK10=mean(WW10)*ds/(2*pi*log(2));
    EK11= mean(WW11)*ds/(2*pi*log(2));
    EK12= mean(WW12)*ds/(2*pi*log(2));
    EK13= mean(WW13)*ds/(2*pi*log(2));
    EK14= mean(WW14)*ds/(2*pi*log(2));
    EKu=[EK1; EK2; EK3; EK4; EK5; EK6; EK7; EK8; EK9; EK10; EK11; EK12; EK13; EK14;];
% analise para V
     v = A(:,6);
    N=length(v);
    [C,L] = wavedec(v,1,'haar');
    W1= detcoef(C,L,1);
    [C,L] = wavedec(v,2,'haar');
    W2= detcoef(C,L,2);
    [C,L] = wavedec(v,3,'haar');
    W3= detcoef(C,L,3);
    [C,L] = wavedec(v,4,'haar');
    W4= detcoef(C,L,4);
    [C,L] = wavedec(v,5,'haar');
    W5= detcoef(C,L,5);
    [C,L] = wavedec(v,6,'haar');
    W6= detcoef(C,L,6);
    [C,L] = wavedec(v,7,'haar');
    W7= detcoef(C,L,7);
    [C,L] = wavedec(v,8,'haar');
    W8= detcoef(C,L,8);
    [C,L] = wavedec(v,9,'haar');
    W9= detcoef(C,L,9);
    [C,L] = wavedec(v,10,'haar');
    W10= detcoef(C,L,10);
    [C,L] = wavedec(v,11,'haar');
    W11= detcoef(C,L,11);
    [C,L] = wavedec(v,12,'haar');
    W12= detcoef(C,L,12);
    [C,L] = wavedec(v,13,'haar');
    W13= detcoef(C,L,13);
    [C,L] = wavedec(v,14,'haar');
    W14= detcoef(C,L,14);
    % calculo do quadrado dos coeficienTes de da somatoria
    WW1=W1.*W1;
    WW2=W2.*W2;
    WW3=W3.*W3;
    WW4=W4.*W4;
    WW5=W5.*W5;
    WW6=W6.*W6;
    WW7=W7.*W7;
    WW8=W8.*W8;
    WW9=W9.*W9;
    WW10=W10.*W10;
    WW11=W11.*W11;
    WW12=W12.*W12;
    WW13=W13.*W13;
    WW14=W14.*W14;
% calculo da funçao de densidade de energia
    EK1= mean(WW1)*ds/(2*pi*log(2));
    EK2= mean(WW2)*ds/(2*pi*log(2));
    EK3= mean(WW3)*ds/(2*pi*log(2));
    EK4= mean(WW4)*ds/(2*pi*log(2));
    EK5= mean(WW5)*ds/(2*pi*log(2));
    EK6= mean(WW6)*ds/(2*pi*log(2));
    EK7= mean(WW7)*ds/(2*pi*log(2));
    EK8= mean(WW8)*ds/(2*pi*log(2));
    EK9= mean(WW9)*ds/(2*pi*log(2));
    EK10=mean(WW10)*ds/(2*pi*log(2));
    EK11= mean(WW11)*ds/(2*pi*log(2));
    EK12= mean(WW12)*ds/(2*pi*log(2));
    EK13= mean(WW13)*ds/(2*pi*log(2));
    EK14= mean(WW14)*ds/(2*pi*log(2));
     EKv=[EK1; EK2; EK3; EK4; EK5; EK6; EK7; EK8; EK9; EK10; EK11; EK12; EK13; EK14;];
% analise para W
    w = A(:,7);
    N=length(w);
    [C,L] = wavedec(w,1,'haar');
    W1= detcoef(C,L,1);
    [C,L] = wavedec(w,2,'haar');
    W2= detcoef(C,L,2);
    [C,L] = wavedec(w,3,'haar');
    W3= detcoef(C,L,3);
    [C,L] = wavedec(w,4,'haar');
    W4= detcoef(C,L,4);
    [C,L] = wavedec(w,5,'haar');
    W5= detcoef(C,L,5);
    [C,L] = wavedec(w,6,'haar');
    W6= detcoef(C,L,6);
    [C,L] = wavedec(w,7,'haar');
    W7= detcoef(C,L,7);
    [C,L] = wavedec(w,8,'haar');
    W8= detcoef(C,L,8);
    [C,L] = wavedec(w,9,'haar');
    W9= detcoef(C,L,9);
    [C,L] = wavedec(w,10,'haar');
    W10= detcoef(C,L,10);
    [C,L] = wavedec(w,11,'haar');
    W11= detcoef(C,L,11);
    [C,L] = wavedec(w,12,'haar');
    W12= detcoef(C,L,12);
    [C,L] = wavedec(w,13,'haar');
    W13= detcoef(C,L,13);
    [C,L] = wavedec(w,14,'haar');
    W14= detcoef(C,L,14);
     % calculo do quadrado dos coeficienTes de da somatoria
    WW1=W1.*W1;
    WW2=W2.*W2;
    WW3=W3.*W3;
    WW4=W4.*W4;
    WW5=W5.*W5;
    WW6=W6.*W6;
    WW7=W7.*W7;
    WW8=W8.*W8;
    WW9=W9.*W9;
    WW10=W10.*W10;
    WW11=W11.*W11;
    WW12=W12.*W12;
    WW13=W13.*W13;
    WW14=W14.*W14;
% calculo da funçao de densidade de energia
    EK1= mean(WW1)*ds/(2*pi*log(2));
    EK2= mean(WW2)*ds/(2*pi*log(2));
    EK3= mean(WW3)*ds/(2*pi*log(2));
    EK4= mean(WW4)*ds/(2*pi*log(2));
    EK5= mean(WW5)*ds/(2*pi*log(2));
    EK6= mean(WW6)*ds/(2*pi*log(2));
    EK7= mean(WW7)*ds/(2*pi*log(2));
    EK8= mean(WW8)*ds/(2*pi*log(2));
    EK9= mean(WW9)*ds/(2*pi*log(2));
    EK10=mean(WW10)*ds/(2*pi*log(2));
    EK11= mean(WW11)*ds/(2*pi*log(2));
    EK12= mean(WW12)*ds/(2*pi*log(2));
    EK13= mean(WW13)*ds/(2*pi*log(2));
    EK14= mean(WW14)*ds/(2*pi*log(2));
    EKw=[EK1; EK2; EK3; EK4; EK5; EK6; EK7; EK8; EK9; EK10; EK11; EK12; EK13; EK14;];
   F= (ventomedio/2*pi).*K;
   EFT=(2*pi/ventomedio)*EKt;
   EFU=(2*pi/ventomedio)*EKu;
   EFV=(2*pi/ventomedio)*EKv;
   EFW=(2*pi/ventomedio)*EKw;
 
save EFT -ASCII EFT
save EFU -ASCII EFU
save EFV -ASCII EFV
save EFW -ASCII EFW
F= (ventomedio/2*pi).*K;
  save F -ASCII F 
uBAR=mean(u);
vBAR=mean(v);
wBAR=mean(w);
tBAR=mean(t);
TALu=std(u);
TALv=std(v);
TALw=std(w);
TALt=std(t);
uLIN=u-uBAR;
vLIN=v-vBAR;
wLIN=w-wBAR;
tLIN=t-tBAR;

end
echo off

